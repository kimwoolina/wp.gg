<form action="{% url 'articles:articles' %}" method="POST" enctype="multipart/form-data">
    {% csrf_token %}
    
    <!-- 1. ìœ ì € ê²€ìƒ‰ ê¸°ëŠ¥ -->
    <div>
        <input type="text" id="user-search" placeholder="Search for users by username or riot_username">
        <select id="reviewee" name="reviewee">
            <option value="">--í‰ê°€ í•  ì‚¬ëŒì„ ê³ ë¥´ì„¸ìš”--</option>
        </select>
    </div>
    
    <!-- 2. ì´ë¯¸ì§€ ì—…ë¡œë“œ ë° ë¯¸ë¦¬ë³´ê¸° -->
    <label for="img">Image</label>
    <input type="file" name="img" id="img" multiple accept="image/*" onchange="previewImages(event)">
    <div id="image-preview"></div>

    <!-- 3. title & content -->
    <label for="title">Title</label>
    <input type="text" name="title" id="title" required><br>
    
    <label for="content">Content</label>
    <input type="text" name="content" id="content" required><br>

    <!-- 4. ì´ëª¨í‹°ì½˜ ì ìˆ˜ ì„ íƒ -->
    <label for="article_score">Score</label>
    <div id="emoji-score">
        <label>
            <input type="radio" name="article_score" value="10" required> ğŸ˜
        </label>
        <label>
            <input type="radio" name="article_score" value="9" required> ğŸ¥°
        </label>
        <label>
            <input type="radio" name="article_score" value="8" required> ğŸ˜˜
        </label>
        <label>
            <input type="radio" name="article_score" value="7" required> ğŸ˜„
        </label>
        <label>
            <input type="radio" name="article_score" value="6" required> ğŸ˜™
        </label>
        <label>
            <input type="radio" name="article_score" value="5" required> ğŸ™‚
        </label>
        <label>
            <input type="radio" name="article_score" value="4" required> ğŸ¥º
        </label>
        <label>
            <input type="radio" name="article_score" value="3" required> ğŸ˜
        </label>
        <label>
            <input type="radio" name="article_score" value="2" required> ğŸ˜£
        </label>
        <label>
            <input type="radio" name="article_score" value="1" required> ğŸ˜¡
        </label>
        <label>
            <input type="radio" name="article_score" value="0" required> ğŸ¤®
        </label>
    </div>

    <!-- 5. í‰ê°€ í•­ëª©ë“¤ -->
    <label> í‰ê°€ í•­ëª©</label>
    <div>
        <input type="checkbox" id="kindness" value="1" name="evaluation">
        <label for="kindness">Kindness</label>

        <input type="checkbox" id="teamwork" value="1" name="evaluation">
        <label for="teamwork">Teamwork</label>

        <input type="checkbox" id="communication" value="1" name="evaluation">
        <label for="communication">Communication</label>

        <input type="checkbox" id="mental_strength" value="1" name="evaluation">
        <label for="mental_strength">Mental Strength</label>

        <input type="checkbox" id="punctuality" value="1" name="evaluation">
        <label for="punctuality">Punctuality</label>

        <input type="checkbox" id="positivity" value="1" name="evaluation">
        <label for="positivity">Positivity</label>

        <input type="checkbox" id="mvp" value="1" name="evaluation">
        <label for="mvp">MVP</label>

        <input type="checkbox" id="mechanical_skill" value="1" name="evaluation">
        <label for="mechanical_skill">Mechanical Skill</label>

        <input type="checkbox" id="operation" value="1" name="evaluation">
        <label for="operation">Operation</label>

        <input type="checkbox" id="negativity" value="1" name="evaluation">
        <label for="negativity">Negativity</label>

        <input type="checkbox" id="profanity" value="1" name="evaluation">
        <label for="profanity">Profanity</label>

        <input type="checkbox" id="afk" value="1" name="evaluation">
        <label for="afk">AFK</label>

        <input type="checkbox" id="cheating" value="1" name="evaluation">
        <label for="cheating">Cheating</label>

        <input type="checkbox" id="verbal_abuse" value="1" name="evaluation">
        <label for="verbal_abuse">Verbal Abuse</label>
    </div>

    <input type="submit" value="Save" />
</form>

<script>
// 1. ìœ ì € ê²€ìƒ‰ ê¸°ëŠ¥
document.getElementById('user-search').addEventListener('input', function (e) {
    const query = e.target.value;
    const revieweeSelect = document.getElementById('reviewee');
    revieweeSelect.innerHTML = '<option value="">--í‰ê°€ í•  ì‚¬ëŒì„ ê³ ë¥´ì„¸ìš”--</option>';
    
    fetch(`/api/articles/search_user/?q=${query}`)
        .then(response => response.json())
        .then(data => {
            data.users.forEach(user => {
                const option = document.createElement('option');
                option.value = user.id;
                option.textContent = `${user.username} | ${user.riot_username}${user.riot_tag}`;
                revieweeSelect.appendChild(option);
            });
        });
});

// 2. ì´ë¯¸ì§€ ë¯¸ë¦¬ë³´ê¸° ê¸°ëŠ¥
function previewImages(event) {
    const previewContainer = document.getElementById('image-preview');
    previewContainer.innerHTML = '';
    
    const files = event.target.files;
    Array.from(files).forEach(file => {
        const reader = new FileReader();
        reader.onload = function (e) {
            const imgElement = document.createElement('img');
            imgElement.src = e.target.result;
            imgElement.style.maxWidth = '100px';
            imgElement.style.marginRight = '10px';
            previewContainer.appendChild(imgElement);
        };
        reader.readAsDataURL(file);
    });
}

// 3. ë¼ë””ì˜¤ ë²„íŠ¼ ì„ íƒ í•´ì œ ê¸°ëŠ¥
function toggleRadio(radio) {
    if (radio.checked) {
        radio.checked = false;
    }
}
</script>
